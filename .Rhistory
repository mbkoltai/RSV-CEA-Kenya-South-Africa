kenya_burden_percap=data.frame(age=1:age_maxval,mean=rowMeans(country_rsv_rate),sd=apply(country_rsv_rate,1,sd),type='cases_per_cap')
hosp_prob_mat_tidy=data.frame(age=1:age_maxval,mean=rowMeans(hosp_prob_mat),sd=apply(hosp_prob_mat,1,sd),type='hosp');
cfr_mat_tidy=data.frame(age=1:age_maxval,mean=rowMeans(cfr_mat),sd=apply(cfr_mat,1,sd),type='cfr')
kenya_burden_all=rbind(kenya_burden_abs,kenya_burden_percap,hosp_prob_mat_tidy,cfr_mat_tidy)
# plot KENYA mean with stdev
ggplot(kenya_burden_all,aes(x=age,y=mean)) + geom_line() + geom_point() +
geom_ribbon(aes(ymin=mean-sd,ymax=mean+sd),alpha=0.3,colour=NA,fill="red") +
facet_wrap(~type,scales='free',nrow=2) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
xlab('Age (month)') + ylab('Total burden') + labs(color="Samples") + ggtitle('Kenya RSV burden (mean +/- stdev)')
kenya_burden_abs=data.frame(age=1:age_maxval,mean=rowMeans(country_rsv_pred_cases),sd=apply(country_rsv_pred_cases,1,sd),type='number_cases');
kenya_burden_percap=data.frame(age=1:age_maxval,mean=rowMeans(country_rsv_rate),sd=apply(country_rsv_rate,1,sd),type='cases_per_cap')
hosp_prob_mat_tidy=data.frame(age=1:age_maxval,mean=rowMeans(hosp_prob_mat),sd=apply(hosp_prob_mat,1,sd),type='hosp');
cfr_mat_tidy=data.frame(age=1:age_maxval,mean=rowMeans(cfr_mat),sd=apply(cfr_mat,1,sd),type='cfr')
kenya_burden_all=rbind(kenya_burden_abs,kenya_burden_percap,hosp_prob_mat_tidy,cfr_mat_tidy)
# plot KENYA mean with stdev
ggplot(kenya_burden_all,aes(x=age,y=mean)) + geom_line() + geom_point() +
geom_ribbon(aes(ymin=mean-sd,ymax=mean+sd),alpha=0.3,colour=NA,fill="red") +
facet_wrap(~type,scales='free',nrow=2) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
xlab('Age (month)') + ylab('Total burden') + labs(color="Samples") + ggtitle('Kenya RSV burden (mean +/- stdev)')
kenya_burden_abs=data.frame(age=1:age_maxval,mean=rowMeans(country_rsv_pred_cases),sd=apply(country_rsv_pred_cases,1,sd),type='number_cases');
kenya_burden_percap=data.frame(age=1:age_maxval,mean=rowMeans(country_rsv_rate),sd=apply(country_rsv_rate,1,sd),type='cases_per_cap')
hosp_prob_mat_tidy=data.frame(age=1:age_maxval,mean=rowMeans(hosp_prob_mat),sd=apply(hosp_prob_mat,1,sd),type='probab_hospit');
cfr_mat_tidy=data.frame(age=1:age_maxval,mean=rowMeans(cfr_mat),sd=apply(cfr_mat,1,sd),type='hospit_cfr')
kenya_burden_all=rbind(kenya_burden_abs,kenya_burden_percap,hosp_prob_mat_tidy,cfr_mat_tidy)
# plot KENYA mean with stdev
ggplot(kenya_burden_all,aes(x=age,y=mean)) + geom_line() + geom_point() +
geom_ribbon(aes(ymin=mean-sd,ymax=mean+sd),alpha=0.3,colour=NA,fill="red") +
facet_wrap(~type,scales='free',nrow=2) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
xlab('Age (month)') + ylab('Total burden') + labs(color="Samples") + ggtitle('Kenya RSV burden (mean +/- stdev)')
ggsave("output/RSV_burden_kenya_randomsamples.png",width=30,height=18,units="cm")
ggplot(lmic_ts_all,aes(x=mos,y=pred,group=iter,color=as.factor(iter))) + geom_line() +
facet_wrap(~type,scales='free',nrow=2) + scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) + theme_bw() +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
xlab('Age (month)') + ylab('Total burden') + labs(color="Samples") + ggtitle('LMIC incidence (random samples)')
n_sample=25
incidence_sample=incidence_lmic_ts_n5000[incidence_lmic_ts_n5000$iter<=n_sample,]; age_maxval=max(incidence_sample$mos)
incidence_sample$type='num_cases_per_1000'
cfr_sample=cfr_lmic_ts_n5000[cfr_lmic_ts_n5000$iter<=n_sample,]; cfr_sample$type='hospit_cfr'; colnames(cfr_sample)[1]='X1';
hosp_prob_sample=hosp_prob_ts_n5000[hosp_prob_ts_n5000$iter<=n_sample,]
hosp_prob_sample$type='probab_hospit'; colnames(hosp_prob_sample)[1]='X1';
lmic_ts_all=rbind(incidence_sample,cfr_sample,hosp_prob_sample)
# plot
ggplot(lmic_ts_all,aes(x=mos,y=pred,group=iter,color=as.factor(iter))) + geom_line() +
facet_wrap(~type,scales='free',nrow=2) + scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) + theme_bw() +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
xlab('Age (month)') + ylab('Total burden') + labs(color="Samples") + ggtitle('LMIC incidence (random samples)')
ggsave("output/RSV_burden_lmic_randomsamples_prob_ts_n5000.png",width=30,height=18,units="cm")
incidence_month_means=incidence_lmic_ts_n5000 %>% group_by(mos) %>% summarise(meanpred=mean(pred),minpred=mean(pred)-sd(pred),maxpred=mean(pred)+sd(pred))
incidence_month_means$type='cases_per_1000'
cfr_month_means=cfr_lmic_ts_n5000 %>% group_by(mos) %>% summarise(meanpred=mean(pred),minpred=mean(pred)-sd(pred),maxpred=mean(pred)+sd(pred))
cfr_month_means$type='hospit_cfr'
hosp_prob_means = hosp_prob_ts_n5000 %>% group_by(mos) %>% summarise(meanpred=mean(pred),minpred=mean(pred)-sd(pred),maxpred=mean(pred)+sd(pred))
hosp_prob_means$type='probab_hospit'
incidence_cfr_hospprob_means=rbind(incidence_month_means,cfr_month_means,hosp_prob_means)
# plot LMIC mean + stdev
ggplot(incidence_cfr_hospprob_means,aes(x=mos,y=meanpred)) + geom_line() + geom_point() +
geom_ribbon(aes(ymin=minpred,ymax=maxpred),alpha=0.3,colour=NA,fill="red") + theme_bw() + facet_wrap(~type,scales='free',nrow=2) +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),text=element_text(family="Calibri"),
plot.title=element_text(hjust=0.5,size=16),axis.text.x=element_text(size=11,angle=90,vjust=0.5)) + xlab('month') + ylab('incidence') +
ggtitle('LMIC RSV incidence, CFR, hospitalisation (mean [-/+ stdev])')
ggsave("output/incidence_cfr_hospprob_lmic_ts_n5000.png",width=30,height=18,units="cm")
ggplot(RSV_burden_Shi_2017_tidy,aes(x=location_name,y=value,group=1)) + geom_line() + geom_point(size=1) +
geom_ribbon(aes(ymin=lower_CI,ymax=upper_CI),alpha=0.3,colour=NA,fill="red") + facet_wrap(~variable,nrow=2,scales='free') +
theme(axis.text.x=element_text(angle=90,vjust=0.5,hjust=1,size=5)) + scale_y_continuous(trans='log10')
ggplot(kenya_burden_all,aes(x=age,y=mean)) + geom_line() + geom_point() +
geom_ribbon(aes(ymin=mean-sd,ymax=mean+sd),alpha=0.3,colour=NA,fill="red") +
facet_wrap(~type,scales='free',nrow=2) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
xlab('Age (month)') + ylab('Total burden') + labs(color="Samples") + ggtitle('Kenya RSV burden (mean +/- stdev)')
kenya_data_path='../path_rsv_data/SARI_Rates_2010_2018/SARI_Rates_2010_2018_tidydata_cleaned.csv'
SARI_Rates_2010_2018_tidydata=read_csv(kenya_data_path)
kenya_rsv_data_timemeans=SARI_Rates_2010_2018_tidydata[
SARI_Rates_2010_2018_tidydata$age_in_months %in% "<60" &
SARI_Rates_2010_2018_tidydata$region %in% 'Kenya' &
SARI_Rates_2010_2018_tidydata$RSV_association &
SARI_Rates_2010_2018_tidydata$period %in% '2010-2018',]
dim(kenya_data_path)
dim(kenya_rsv_data_timemeans)
kenya_rsv_data_timemeans
kenya_rsv_data_timemeans=SARI_Rates_2010_2018_tidydata[
# SARI_Rates_2010_2018_tidydata$age_in_months %in% "<60" &
SARI_Rates_2010_2018_tidydata$region %in% 'Kenya' &
SARI_Rates_2010_2018_tidydata$RSV_association &
SARI_Rates_2010_2018_tidydata$period %in% '2010-2018',]
dim(kenya_rsv_data_timemeans)
kenya_rsv_data_timemeans
View(kenya_rsv_data_timemeans)
list.files('../path_rsv_data/')
file.edit('../path_rsv_data/RSV_kenya_plotting.R')
kenya_rsv_data_timemeans
nonsumm_truthvals=!grepl("<|24-59|12-23",SARI_Rates_2010_2018_tidydata$age_in_months) |
grepl("<1$",SARI_Rates_2010_2018_tidydata$age_in_months)
kenya_rsv_data_timemeans=SARI_Rates_2010_2018_tidydata[
nonsumm_truthvals &
SARI_Rates_2010_2018_tidydata$region %in% 'Kenya' &
SARI_Rates_2010_2018_tidydata$RSV_association &
SARI_Rates_2010_2018_tidydata$period %in% '2010-2018',]
kenya_rsv_data_timemeans=SARI_Rates_2010_2018_tidydata[
nonsumm_truthvals & # dont include summary variables that subsume others
SARI_Rates_2010_2018_tidydata$region %in% 'Kenya' &
SARI_Rates_2010_2018_tidydata$RSV_association &
SARI_Rates_2010_2018_tidydata$period %in% '2010-2018',]
kenya_rsv_data_timemeans
life_table$lx
life_table$age
unique(kenya_rsv_data_timemeans$age_in_months)
kenya_rsv_data_timemeans$age_inf=kenya_rsv_data_timemeans$age_in_months
kenya_rsv_data_timemeans$age_inf
kenya_rsv_data_timemeans$age_inf[kenya_rsv_data_timemeans$age_inf %in% '<1']=0
kenya_rsv_data_timemeans$age_inf
kenya_rsv_data_timemeans$age_inf %in% '-'
grepl('-',kenya_rsv_data_timemeans$age_inf)
kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)]
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')})
as.numeric(sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))
as.numeric(unlist(sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')})))
matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),ncol=2)
matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=F)
matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T)
rowMeans(matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T))
kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)]=rowMeans(matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T))
kenya_rsv_data_timemeans$age_inf
kenya_rsv_data_timemeans$age_inf
matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T)
kenya_rsv_data_timemeans$age_inf=as.numeric(kenya_rsv_data_timemeans$age_in_months)
kenya_rsv_data_timemeans$age_inf[kenya_rsv_data_timemeans$age_inf %in% '<1']=0
kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)]=rowMeans(matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T))
kenya_rsv_data_timemeans$age_inf
kenya_rsv_data_timemeans$age_inf=kenya_rsv_data_timemeans$age_in_months
kenya_rsv_data_timemeans$age_inf[kenya_rsv_data_timemeans$age_inf %in% '<1']=0
kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)]=rowMeans(matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T))
kenya_rsv_data_timemeans$age_inf
kenya_rsv_data_timemeans$age_inf=kenya_rsv_data_timemeans$age_in_months
matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T)
rowMeans(matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T))
kenya_rsv_data_timemeans$age_inf=kenya_rsv_data_timemeans$age_in_months; kenya_rsv_data_timemeans$age_inf[kenya_rsv_data_timemeans$age_inf %in% '<1']=0
kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)]=as.numeric(rowMeans(matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T)))
kenya_rsv_data_timemeans$age_inf
kenya_rsv_data_timemeans$age_inf=kenya_rsv_data_timemeans$age_in_months; kenya_rsv_data_timemeans$age_inf[kenya_rsv_data_timemeans$age_inf %in% '<1']=0
as.numeric(rowMeans(matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T)))
kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)]=as.numeric(rowMeans(matrix(as.numeric(unlist(
sapply(kenya_rsv_data_timemeans$age_inf[grepl('-',kenya_rsv_data_timemeans$age_inf)], function(x) {strsplit(x,'-')}))),
ncol=2,byrow=T)))
kenya_rsv_data_timemeans$age_inf
kenya_rsv_data_timemeans$age_inf=as.numeric(kenya_rsv_data_timemeans$age_inf)
kenya_rsv_data_timemeans$age_inf
approx(kenya_rsv_data_timemeans$age_inf,life_table$lx)
life_table$lx
approx(kenya_rsv_data_timemeans$age_inf,life_table$age)
rnorm(10)
kenya_burden_all$age
kenya_burden_all$type
head(kenya_rsv_data_timemeans,3)
kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper')]
kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper','hospitalisations')]
kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper','hospitalisation')]
kenya_pred_data_comb = kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper','hospitalisation')]
unique(kenya_burden_all$type)
kenya_burden_all$type %in% 'cases_per_cap'
colnames(kenya_burden_all)
kenya_burden_all[kenya_burden_all$type %in% 'cases_per_cap',c("age","mean","sd")]
kenya_rsv_data_timemeans
kenya_burden_all[kenya_burden_all$type %in% 'cases_per_cap',c("age","mean","sd")]
kenya_pred=kenya_burden_all[kenya_burden_all$type %in% 'cases_per_cap',c("age","mean","sd")]
kenya_pred$CI_lower=kenya_pred$mean-kenya_pred$sd; CI_upper=kenya_pred$mean+kenya_pred$sd
kenya_pred
kenya_pred$CI_lower=kenya_pred$mean-kenya_pred$sd; kenya_pred$CI_upper=kenya_pred$mean+kenya_pred$sd
kenya_pred
kenya_pred=kenya_pred[,c('age','mean','CI_lower','CI_upper')]
kenya_pred_data_comb = kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper','hospitalisation')];kenya_pred_data_comb$type='data'
kenya_pred=kenya_burden_all[kenya_burden_all$type %in% 'cases_per_cap',c("age","mean","sd")];
kenya_pred$CI_lower=kenya_pred$mean-kenya_pred$sd; kenya_pred$CI_upper=kenya_pred$mean+kenya_pred$sd
kenya_pred=kenya_pred[,c('age','mean','CI_lower','CI_upper')]; kenya_pred$hospitalisation=FALSE; kenya_pred$type='pred'
kenya_pred_data_comb
kenya_pred
colnames(kenya_pred)=colnames(kenya_pred_data_comb)
length(unique(kenya_pred_data_comb$type))
if (length(unique(kenya_pred_data_comb$type))==1){
kenya_pred_data_comb=rbind(kenya_pred_data_comb,kenya_pred)
}
kenya_pred_data_comb
length(unique(kenya_pred_data_comb$type))==1
length(unique(kenya_pred_data_comb$type))
Vie
View(kenya_pred_data_comb)
kenya_pred
kenya_pred_data_comb$rate*1e5
View(kenya_pred)
(kenya_pred$rate)*1e5
kenya_pred*1e5
colnames(kenya_pred)
kenya_pred[,c("rate","CI_lower","CI_upper")]
kenya_pred[,c("rate","CI_lower","CI_upper")]*1e5
kenya_pred_data_comb = kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper','hospitalisation')];kenya_pred_data_comb$type='data'
kenya_pred=kenya_burden_all[kenya_burden_all$type %in% 'cases_per_cap',c("age","mean","sd")];
kenya_pred[,c("rate","CI_lower","CI_upper")]=kenya_pred[,c("rate","CI_lower","CI_upper")]*1e5
kenya_pred$CI_lower=kenya_pred$mean-kenya_pred$sd; kenya_pred$CI_upper=kenya_pred$mean+kenya_pred$sd
kenya_pred=kenya_pred[,c('age','mean','CI_lower','CI_upper')]; kenya_pred$hospitalisation=FALSE; kenya_pred$type='pred'
colnames(kenya_pred)=colnames(kenya_pred_data_comb)
if (length(unique(kenya_pred_data_comb$type))==1){
kenya_pred_data_comb=rbind(kenya_pred_data_comb,kenya_pred)
}
View(kenya_pred_data_comb)
kenya_pred_data_comb = kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper','hospitalisation')];kenya_pred_data_comb$type='data'
kenya_pred=kenya_burden_all[kenya_burden_all$type %in% 'cases_per_cap',c("age","mean","sd")];
kenya_pred$CI_lower=kenya_pred$mean-kenya_pred$sd; kenya_pred$CI_upper=kenya_pred$mean+kenya_pred$sd
kenya_pred=kenya_pred[,c('age','mean','CI_lower','CI_upper')]; kenya_pred$hospitalisation=FALSE; kenya_pred$type='pred'
colnames(kenya_pred)=colnames(kenya_pred_data_comb);
if (length(unique(kenya_pred_data_comb$type))==1){
kenya_pred[,c("rate","CI_lower","CI_upper")]=kenya_pred[,c("rate","CI_lower","CI_upper")]*1e5
kenya_pred_data_comb=rbind(kenya_pred_data_comb,kenya_pred)
}
colnames(kenya_pred_data_comb)
kenya_pred_data_comb = kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper','hospitalisation')];
kenya_pred_data_comb = kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper','hospitalisation')];
colnames(kenya_pred_data_comb)
kenya_pred_data_comb %>% group_by(age_inf) %>% summarize(age_inf=sum(rate),CI_lower=sum(CI_lower),CI_upper=sum(CI_upper))
colnames(kenya_pred_data_comb)
kenya_pred_data_comb %>% group_by(age_inf) %>%
summarize(age_inf=age_inf,rate=sum(rate),CI_lower=sum(CI_lower),CI_upper=sum(CI_upper),hospitalisation='both')
kenya_pred_data_comb %>% group_by(age_inf) %>%
summarize(rate=sum(rate),CI_lower=sum(CI_lower),CI_upper=sum(CI_upper),hospitalisation='both')
datasum=kenya_pred_data_comb %>% group_by(age_inf) %>%
summarize(rate=sum(rate),CI_lower=sum(CI_lower),CI_upper=sum(CI_upper),hospitalisation='both')
colnames(datasum)
colnames(kenya_pred_data_comb)
rbind(kenya_pred_data_comb,datasum)
unique(kenya_pred_data_comb$hospitalisation)
length(unique(kenya_pred_data_comb$hospitalisation))
kenya_pred_data_comb = kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper','hospitalisation')];
datasum=kenya_pred_data_comb %>% group_by(age_inf) %>%
summarize(rate=sum(rate),CI_lower=sum(CI_lower),CI_upper=sum(CI_upper),hospitalisation='both')
if (length(unique(kenya_pred_data_comb$hospitalisation))==2){
kenya_pred_data_comb=rbind(kenya_pred_data_comb,datasum)
}
kenya_pred_data_comb$hospitalisation
kenya_pred_data_comb = kenya_rsv_data_timemeans[,c('age_inf','rate','CI_lower','CI_upper','hospitalisation')];
datasum=kenya_pred_data_comb %>% group_by(age_inf) %>%
summarize(rate=sum(rate),CI_lower=sum(CI_lower),CI_upper=sum(CI_upper),hospitalisation='both')
kenya_pred_data_comb$hospitalisation[kenya_pred_data_comb$hospitalisation]
kenya_pred_data_comb$hospitalisation[kenya_pred_data_comb$hospitalisation]='hosp'
kenya_pred_data_comb$hospitalisation[!kenya_pred_data_comb$hospitalisation]='nonhosp'
kenya_pred_data_comb$hospitalisation[kenya_pred_data_comb$hospitalisation %in% 'FALSE']='nonhosp'
kenya_pred_data_comb$hospitalisation
kenya_pred_data_comb=rbind(kenya_pred_data_comb,datasum)
kenya_pred_data_comb$type='data'
kenya_pred=kenya_burden_all[kenya_burden_all$type %in% 'cases_per_cap',c("age","mean","sd")];
kenya_pred$CI_lower=kenya_pred$mean-kenya_pred$sd; kenya_pred$CI_upper=kenya_pred$mean+kenya_pred$sd
kenya_pred=kenya_pred[,c('age','mean','CI_lower','CI_upper')]; kenya_pred$hospitalisation='both'; kenya_pred$type='pred'
colnames(kenya_pred)=colnames(kenya_pred_data_comb);
if (length(unique(kenya_pred_data_comb$type))==1){
kenya_pred[,c("rate","CI_lower","CI_upper")]=kenya_pred[,c("rate","CI_lower","CI_upper")]*1e5
kenya_pred_data_comb=rbind(kenya_pred_data_comb,kenya_pred)
}
ggplot(kenya_pred_data_comb,aes(x=age_inf,y=rate,group=interaction(type,hospitalisation))) + geom_line()
ggplot(kenya_pred_data_comb,aes(x=age_inf,y=rate,color=type,shape=hospitalisation,group=interaction(type,hospitalisation))) +
geom_line()
ggplot(kenya_pred_data_comb,aes(x=age_inf,y=rate,color=type,shape=hospitalisation,group=interaction(type,hospitalisation))) +
geom_line() + geom_point()
ggplot(kenya_pred_data_comb,aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point()
ggplot(kenya_pred_data_comb,aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=mean-sd,ymax=mean+sd),alpha=0.3,colour=NA,fill="red") + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2))
ggplot(kenya_pred_data_comb,aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper),alpha=0.3,colour=NA,fill="red") + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2))
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper),alpha=0.3,colour=NA,fill="red") + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2))
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper),alpha=0.3,color=type) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2))
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2))
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
xlab('Age (month)') + ylab('Total burden') + labs(color="Samples") + ggtitle('Kenya RSV burden (mean +/- stdev)')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5/100 thousand population')
16e3
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + coord_cartesian(xlim=c(0,60),ylim=c(0,16e3)) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5/100 thousand population')
ggsave("output/RSV_burden_kenya_data_pred_compare.png",width=30,height=18,units="cm")
kenya_pred_data_comb$age_inf
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
scale_x_discrete(drop=FALSE) + coord_cartesian(xlim=c(0,60),ylim=c(0,16e3)) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_discrete(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + coord_cartesian(xlim=c(0,60),ylim=c(0,16e3)) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + coord_cartesian(xlim=c(0,60),ylim=c(0,16e3)) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),drop=F) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + coord_cartesian(xlim=c(0,60),ylim=c(0,16e3)) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),limits=c(0,60)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + coord_cartesian(xlim=c(0,60),ylim=c(0,16e3)) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),limits=c(0,60)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + xlim(c(0,60)) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
# scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),limits=c(0,60)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),limits=c(0,60)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
coord_cartesian(xlim=c(0,60)) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),limits=c(0,60)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
coord_cartesian(xlim=c(0,50)) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),limits=c(0,60)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
coord_cartesian(xlim=c(0,58)) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),limits=c(0,60)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) +
coord_cartesian(xlim=c(0,60),expand=F) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),limits=c(0,60)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + coord_cartesian(xlim=c(-0.5,54),expand=F) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),limits=c(0,60)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + coord_cartesian(xlim=c(-1,54),expand=F) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2),limits=c(0,60)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + coord_cartesian(xlim=c(-0.75,54),expand=F) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggsave("output/RSV_burden_kenya_data_pred_compare.png",width=30,height=18,units="cm")
seq(0,ymax,ymax/6)
ymax=15e3
seq(0,ymax,ymax/6)
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation)) + geom_point() +
geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) + theme_bw() +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
scale_y_continuous(labels=as.character(seq(0,ymax,6)),breaks=seq(0,ymax,6)) +
theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + coord_cartesian(xlim=c(-0.75,54),expand=F) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggplot(kenya_pred_data_comb[!kenya_pred_data_comb$hospitalisation %in% "nonhosp",],
aes(x=age_inf,y=rate,color=type,group=interaction(type,hospitalisation))) +
geom_line(aes(linetype=hospitalisation))+geom_point()+geom_ribbon(aes(ymin=CI_lower,ymax=CI_upper,color=type,fill=type),alpha=0.3) +
scale_x_continuous(labels=as.character(seq(0,age_maxval,2)),breaks=seq(0,age_maxval,2)) +
scale_y_continuous(labels=as.character(seq(0,ymax,ymax/6)),breaks=seq(0,ymax,ymax/6)) +
theme_bw() + theme(panel.grid=element_line(linetype="dashed",colour="black",size=0.1),plot.title=element_text(hjust=0.5,size=16),
axis.text.x=element_text(size=11,angle=90,vjust=0.5),axis.text.y=element_text(size=11),
axis.title=element_text(size=14), text=element_text(family="Calibri")) + coord_cartesian(xlim=c(-0.75,54),expand=F) +
xlab('Age (month)') + ylab('number of cases') + ggtitle('Kenya RSV cases under 5yr, per100 thousand population')
ggsave("output/RSV_burden_kenya_data_pred_compare.png",width=30,height=18,units="cm")
